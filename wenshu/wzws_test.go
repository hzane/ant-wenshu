package main

import (
	"encoding/json"
	"fmt"
	"io/ioutil"

	"gitlab.com/hearts.zhang/ants"
)

func ExampleWZWS() {
	const homepage = `html>
<head>
</head>
<body>
<noscript>
<h1><strong>请开启JavaScript并刷新该页.</strong></h1>
</noscript>
<script type="text/javascript">
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>32?String.fromCharCode(c+32):c.toString(33))};if(!''.replace(/^/,String)){while(c--)d[e(c)]=k[c]||e(c);k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('15 D="k";15 1a="i";15 1b="l";15 11=7;15 F = "e+/=";J g(10) {15 U, N, R;15 o, p, q;R = 10.S;N = 0;U = "";17 (N < R) {o = 10.s(N++) & 6;O (N == R) {U += F.r(o >> a);U += F.r((o & 1) << c);U += "==";n;}p = 10.s(N++);O (N == R) {U += F.r(o >> a);U += F.r(((o & 1) << c) | ((p & 5) >> c));U += F.r((p & 4) << a);U += "=";n;}q = 10.s(N++);U += F.r(o >> a);U += F.r(((o & 1) << c) | ((p & 5) >> c));U += F.r(((p & 4) << a) | ((q & 3) >> d));U += F.r(q & 2);}W U;}J H(){15 16= 19.Q||B.C.u||B.m.u;15 K= 19.P||B.C.t||B.m.t;O (16*K <= 9) {W 14;}15 1d = 19.Y;15 1e = 19.Z;O (1d + 16 <= 0 || 1e + K <= 0 || 1d >= 19.X.18 || 1e >= 19.X.M) {W 14;}W G;}J h(){15 12 = 1a+1b;15 L = 0;15 N    = 0;I(N = 0; N < 12.S; N++) {L += 12.s(N);}L *= b;L += 8;W "j"+L;}J f(){O(H()) {} E {15 A = "";	A = "1c="+g(11.13()) + "; V=/";B.w = A;	15 v = h();A = "1a="+g(v.13()) + "; V=/";B.w = A;	19.T=D;}}f();',59,74,'0|0x3|0x3f|0xc0|0xf|0xf0|0xff|10|111111|120000|2|31|4|6|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|HXXTTKKLLPPP5|KTKY2RBD9NHPBCIHV9ZMEQQDARSLVFDU|QWERTASDFGXYSF|RANDOMSTR5727|WZWS_CONFIRM_PREFIX_LABEL10|/WZWSRELw==|STRRANDOM5727|body|break|c1|c2|c3|charAt|charCodeAt|clientHeight|clientWidth|confirm|cookie|cookieString|document|documentElement|dynamicurl|else|encoderchars|false|findDimensions|for|function|h|hash|height|i|if|innerHeight|innerWidth|len|length|location|out|path|return|screen|screenX|screenY|str|template|tmp|toString|true|var|w|while|width|window|wzwschallenge|wzwschallengex|wzwstemplate|x|y'.split('|'),0,{}))
</script>

</body>
</html>
`
	jse, _ := NewOtto("js")
	_, c, err := WZWSRedirect(homepage, jse)
	fmt.Println(c, err)

	// Output: MTA= <nil>
	// V1pXU19DT05GSVJNX1BSRUZJWF9MQUJFTDEwMTY3NTkz
}
func ExampleDecryptDOCID() {
	const src = `"[{\"RunEval\":\"w61ZS27CgzAQPQtRFsK2wqh6AcKUVcKOw5DDpcOIQhFJGxYNwpVDV1HDrl5MU8OKw4cOEBzDlylPQsKDwrDDp8O3w54MNhbDi33CusOdHRPCmX7DpMKrwpdcwqbCh8K3w6dXwpnCvcKvw7cbwrnDjsK2OxYGIQkIwq/DhRNIwoDCmEfCh8O8ByAzeV3CsSrCocK2EMOgHcOMQsKgemAMw4UFMcKADsOAIAFMwoATwrADOsKAGjwBHCDCoQIQaAQvBcKPwqJ4wrVIwrLDgzHCl8KfScKew4lFFFMsworCi8Kxw7B0VmrDlXU6c8O6wrbCpEIIEcKywqDCnMOgw5TDtMKpJsO6Z8OKw4fDpcOvw595YmrCuMOQwqBAw43CkMKgw6LDlgrDmFQPLgbDpmDCrcK8wrXCuldzwqp7w5PCj1fCocOKwqzCuxR1UsOQYsK4w6LCu0pyGMKjwrXDh8OewrQHasKMURvCrXvCm8OBBMKrwqnCplbDrMKbDcO6w5PDq3bDncO3dMKmw40IJhRsZC/DnhZYQcKzXcKZBynCr8OlwpQNMMOuWUVXMMOuG8OCwp/CrjPClcOQwrx9UMOvw57Dp1EFw53CvlR/wojDj8O+wqLDph7CoMKTNcOJwpPDjcOcXkTDt8Opw5gLa33Ci8KfwpHCu8KHwol9ScKgw71ZMMOoGMOlG0vCmgNTBxc1NhzDvWjDnSFNOMOyw7nDgRtSEcKcw7HDqAs=\",\"Count\":\"7857797\"},{\"裁判要旨段原文\":\"本院经审查认为，原判认定王某某明知所借款项为公款、与国家工作人员共谋挪用公款的犯罪事实不清，证据不足，申诉人王某某的申诉符合《中华人民共和国刑事诉讼法》第二百四十二条第（二）项、第（三）项规定的应当重新审判条件。据此，依照《中华人民共和国刑事诉讼法》第二百四十\",\"案件类型\":\"1\",\"裁判日期\":\"2015-10-22\",\"案件名称\":\"王守仁犯挪用公款罪刑事决定书\",\"文书ID\":\"FcONwrkRBDEIBMOAwpQEw4NrCgTDucKHwrR3flc1Mgp1wqfDkSfCt8KVwrDCnFtPwrMRwr4uwpkoFsKVJC9bwrrCtsOew5QSw5nChzMewpzDtcOUwoTCmsKJEQ81w43DijIMw6rDtMOsw48HwqfDkinCr10rcMKwVQTDrizDj8KkKm7DnRTCt3NXBcOywrAefsOCw51zFBg8bSrCscK3wrsDwoDDqsK0OMOzYVPDgz4KHsOxd8KIwp9GJsOFL2tXwpnDhMOQBw==\",\"审判程序\":\"再审\",\"案号\":\"（2015）刑监字第27号\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院认为，被告人崔昌贵、李占勇伙同他人贩卖、运输、制造“麻古”、氯胺酮，其行为已构成贩卖、运输、制造毒品罪。被告人杨林渠伙同他人贩卖、制造“麻古”，其行为已构成贩卖、制造毒品罪。被告人赵建东伙同他人贩卖、运输、制造氯胺酮，其行为已构成贩卖、运输、制造毒品罪。被\",\"案件类型\":\"1\",\"裁判日期\":\"2013-06-24\",\"案件名称\":\"崔昌贵等贩卖、运输、制造毒品、杨林渠贩卖、制造毒品死刑复核刑事裁定书\",\"文书ID\":\"DcOLwrkBw4AwCATCsMKVeA7CsEswwrDDv0hJwqdGRh45w4sUw4XDilnDksOKw4/Dh8OzPsOYYWPDvA7CkyEYwofCoVdGIcOXCWHCvTDCsCnDqcOLNWsLw5HCjD8wVMKuXsKBc8OVNcK1w6JXFgRsVRvCgHI5wpTDm118eHTCiMKOegxeOsKdfSfCoHYLEXTDjzTDnXnCosOUwo7DmiUUCUoFG8KHIhfDmcOCGh4Vd8Ktw6ltwrvDicKbw5TCoA8=\",\"审判程序\":\"其他\",\"案号\":\"无\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院认为，被告人王青志以非法占有为目的，采取暴力手段劫取他人财物，其行为已构成抢劫罪。王青志经预谋后入户抢劫，抢劫数额巨大，并致二人死亡，犯罪性质恶劣，手段残忍，情节、后果特别严重，社会危害性极大，应依法惩处。第一审判决、第二审裁定认定的事实清楚，证据确实、充\",\"案件类型\":\"1\",\"裁判日期\":\"2013-02-25\",\"案件名称\":\"王青志抢劫死刑复核刑事裁定书\",\"文书ID\":\"FcKOw4kBw4AgDMODVgrCuUzCnjlgw7/CkUrDv8KSw6VjwprCqQwdT8OpwpHDtnNjwoTCkGXCs8ONw5LDlMKJwpJCEg9ZKcKrNsKiTMO1wrRjcDTCrTrDlgAewqpgRBRxHgB5w4EMC8Kowr/DtcOtw67Dl37CnFjDucKcLcK7FsOdwr8Tw7TCm3UnAD1kCMOvwoU+wrpbw7bCpcKdV0lKw6tlbm1Swp7ChsOEJGdHZ8OORDs/IsOIw6XCnUvCrsK8w6wmwpIf\",\"审判程序\":\"其他\",\"案号\":\"无\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院认为，被告人马哈买提江·达吾来提故意非法剥夺他人生命，故意伤害他人身体（致人死亡），还以非法占有为目的使用暴力劫取、秘密窃取他人财物，违反出入境管理而偷越国境，其行为已分别构成故意杀人罪、故意伤害罪、抢劫罪、盗窃罪和偷越国境罪，应依法数罪并罚。马哈买提江·\",\"案件类型\":\"1\",\"裁判日期\":\"2013-03-20\",\"案件名称\":\"马哈买提江·达吾来提故意杀人、故意伤害、抢劫、盗窃、偷越国境死刑复核案刑事裁定书\",\"文书ID\":\"FcOJwrkBAzEIBMOAwpbCgMOlESEgw5R/ST7CpzMxLMOLw4rCnBwZwr3CjMK3w7JIw4XDksK9ZcO1w4vCt8K8YiLCnsKpdgDCjB9CwrEFwo1Xw6VfelHCs8OGVTgaw5fDhsOXTcKlwoXDs1EOwpjDtTDCuR4/EcKXaMKmUlfCpmrDh1BZTTdgaEMUWBtXw6PDjQNdKWF3CsOGwqTCiV7DusOiwqApMsOXwrrCrcO0wp1bwp5+W8O6woLDmmPDk8KUwrJDw7ED\",\"审判程序\":\"其他\",\"案号\":\"无\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院认为，被告人吴亚贤组织、领导以暴力、威胁等手段有组织地进行违法犯罪活动，称霸一方，为非作恶，欺压、残害群众，严重破坏当地经济、社会生活秩序的黑社会性质的组织，其行为已构成组织、领导黑社会性质组织罪；吴亚贤指使组织成员故意非法剥夺他人生命，其行为已构成故意杀\",\"案件类型\":\"1\",\"裁判日期\":\"2013-06-18\",\"案件名称\":\"吴亚贤故意杀人、组织、领导黑社会性质组织等死刑复核刑事裁定书\",\"文书ID\":\"DcOMwrcRw4BACADCsMKVSE8owonDu8KPZMO3OilZwo7Dh8Opw53CkhjCqsK1wrx9woEVGyDDosO4PDjDhWDDoMKOw7lARsOOGhbChsKtwpRTw5vClcKQSMKufMO9w6UpSsOLb3UUFU0KwprDpcKpRMKgVAHCvcKLPADCsMOyVsO2w5HDrcOEJMKcDMOtUnQYwprDnsOjwovDhREcw6AGCzwywpzCgMKXwrnCpMOrS8KtcEHDs0/DhAhUw7HCjsKlZk/DqsKpwr52UMO6AA==\",\"审判程序\":\"其他\",\"案号\":\"无\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院经审查认为，申诉人某某的申诉符合《中华人民共和国刑事诉讼法》第二百四十二条规定的应当重新审判的情形。据此，依照《中华人民共和国刑事诉讼法》第二百四十三条第二款的规定，决定如下\",\"案件类型\":\"1\",\"裁判日期\":\"2014-01-01\",\"案件名称\":\"姜淑非法行医罪申诉刑事决定书\",\"文书ID\":\"FcKNw4sRRDEIw4NaIsKGw7A5AsKBw75Lw5rCt8KjwpvDpRnCrS7DiFRpXcOHw4I9MG4kdMOOSxY9wrtVwphlw4jDo1s8w47DjcOYVMOLQGcEe29TwrwswrPCmylNRsK7bMK1WcKUWXPDmcO1woLDtMOdZsK6emnCiMO/wo/CrxLCnMOyw7UIU8KMNjfCn8Kqw5oSdFDCjMK5fMK6WsOmfBPCmMOswoLDj2nDkwPCicOtw5Ahf3jDiEsowohZw6kHw5PDoQXCnsOww4vDvgE=\",\"审判程序\":\"再审\",\"案号\":\"（2014）刑监字第22号\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院认为，被告人张江伟故意非法剥夺他人生命，其行为已构成故意杀人罪。张江伟因不能正确处理婚恋纠纷，持菜刀砍击二被害人要害部位多刀，致一人死亡、一人重伤，犯罪手段残忍，情节恶劣，后果和罪行极其严重，应依法惩处。张江伟曾因犯强奸罪被判处刑罚，在刑罚执行完毕以后五年\",\"案件类型\":\"1\",\"裁判日期\":\"2013-05-20\",\"案件名称\":\"张江伟故意杀人死刑复核刑事裁定书\",\"文书ID\":\"DcKPw4kRw4AwCMOEWmINw6Z4wprCq8O/wpLCkgIkwo0GE8KWb8Ogw5sFZifCqlsqa8K3w5PDmMORQ1rDhSVYHsOWwp7CicK7w6rCnhdPw5kqKcK7wqrDlsO1MMKiw7rCrMKhCCLDvcKgWlfDnTbClsKLOcOxw4jCu8OrwqEjUsOKN8Ouw6BXwrxYwr/Cp2PDoS9xw6XDhzLDusOYw7vCi8OCbXQ5Nk8qU0FNFiNuw5YHwrMuDiJOecKTB0xYwr3DnsKHdyzDvsKDw70A\",\"审判程序\":\"其他\",\"案号\":\"无\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"依照《中华人民共和国刑事诉讼法》第二十六条的规定，决定如下\",\"案件类型\":\"1\",\"裁判日期\":\"2015-06-15\",\"案件名称\":\"李军非法生产、销售间谍专用器材罪请示 刑事决定书\",\"文书ID\":\"JcKNw4sRRDEIw4Naw6LCm8KEIxjDqMK/wqR9M3vClmRrTsKSw6t9fcKjw5hIw500wrwHRMOtGyESHD7ClcKIwpPCnW/CtEQgaUXChx7DhcO9wrQAd8KAwoBoRXfCkcOxw6xLwqjCscOjKMOUwoUhwoAoS8O3GMORw7E1w6gRwrwrNcKXV8K+wqrCv8O/ScKbwqPDrMO9DsOrN8O/PCpkHcKxwq7CpWzCrzg1PyrCt33DrhkTTBFJwpBSwq3DnMO8a8OmwrU2wpY/\",\"审判程序\":\"其他\",\"案号\":\"（2014）刑立他字第26-1号\",\"法院名称\":\"最高人民法院\"},{\"案件类型\":\"1\",\"裁判日期\":\"2014-12-19\",\"案件名称\":\"张文艳受贿罪，张文艳签订、履行合同失职被骗罪审判监督刑事裁定书\",\"文书ID\":\"FcKOw4cRBEEIw4RSw4LCmycMwpB/SMK3V3rCt1pqwqMwd0hFw4xveMOaCFzDuyhMwowoPQPDjyTDtcKAw6kGTTfCgsKtw4A6wqUTwqvDusOjeC9Dw53CoXHDvMK9w6czWMKbfsOOwqXDjwVxeMObw4sOwovCnsKSw7c3NMKQw4RUwovDvlfDgMOgwp7DucKJwqlXwrbDrsOjwr7DtcKEwpnDvnQ1w7nDucOAwpJcdWDDhWPDtcOKBcK6wr/DrzzCkcKew5fDnBouFRosXT8=\",\"审判程序\":\"二审\",\"案号\":\"（2012）刑抗字第4号\",\"法院名称\":\"最高人民法院\"},{\"裁判要旨段原文\":\"本院认为，被告人毛勇伙同他人非法制造甲基苯丙胺43.703千克，并将制造出的甲基苯丙胺予以贩卖，其行为已构成贩卖、制造毒品罪。毛勇积极参与制造甲基苯丙胺，数量巨大，并将9千余克甲基苯丙胺带回家中向他人贩卖，在共同犯罪中起主要作用，系主犯，罪行极其严重，又系累犯\",\"案件类型\":\"1\",\"裁判日期\":\"2015-03-02\",\"案件名称\":\"毛勇贩卖、制造毒品死刑复核刑事裁定书\",\"文书ID\":\"HcOKw4kRBDEIBEHClxohwq4nCMOww5/CpMKdw5hvZcONKjs9EQoqScKlwr7CksO9wprDgWzDh8O4w5LDo8Kxd8KDAiRzwq0rwr81SDTDmFfCjRjCs2hcw6DDvcK5wp5VecKZc8K4worCsk5TGMKfw47DscKXBcOIThXCoQbClsKiw6nDmcKFE3Fowrs3w7lIw4oFUUjCpMK4w7PDiDlbw5HCiMOYwqIvdCbDoDrDtMKiPMKPwqJWe19cXcK4w4NDeVnDusKYJsOoBw==\",\"审判程序\":\"复核\",\"案号\":\"无\",\"法院名称\":\"最高人民法院\"}]"`
	var ret []map[string]interface{}

	jse, err := NewOtto("")
	data, err := JSRun(err, jse, src)

	err = json.Unmarshal([]byte(data), &ret)
	runeval := ants.I2S(ret[0], "RunEval")

	runeval, err = JSCall(err, jse, "CrashRunEval", runeval)
	fmt.Println(runeval, err) // this is the key

	docid := "FcONwrkRBDEIBMOAwpQEw4NrCgTDucKHwrR3flc1Mgp1wqfDkSfCt8KVwrDCnFtPwrMRwr4uwpkoFsKVJC9bwrrCtsOew5QSw5nChzMewpzDtcOUwoTCmsKJEQ81w43DijIMw6rDtMOsw48HwqfDkinCr10rcMKwVQTDrizDj8KkKm7DnRTCt3NXBcOywrAefsOCw51zFBg8bSrCscK3wrsDwoDDqsK0OMOzYVPDgz4KHsOxd8KIwp9GJsOFL2tXwpnDhMOQBw=="
	runeval, err = JSCall(err, jse, `CrashDOCID`, docid)
	fmt.Println(runeval, err)

	// Output: 8d2c2da0b88d45a79485ef87d67b125f <nil>
	// 029bb843-b458-4d1c-8928-fe80da403cfe <nil>
}
func ExampleDOCCreate() {
	jse, _ := NewOtto("js")
	src, _ := ioutil.ReadFile("content.xhr")
	// fmt.Println(src)
	summary, txt, err := CrashCreateContentJS(src, jse)
	fmt.Println(len(summary), len(txt), err)

	// Output: 2374 42460 <nil>
}

func ExampleWZWSHome() {
	jse, _ := NewOtto("js")
	body, _ := ioutil.ReadFile("index.html")
	uri, c, err := WZWSRedirect(string(body), jse)
	fmt.Println(uri, err)
	fmt.Println(c)

	// Output: /WZWSRELw== <nil>
	// Mw==
	// V1pXU19DT05GSVJNX1BSRUZJWF9MQUJFTDMxMjM4NjU=
}

func ExampleWZWSH2() {
	jse, _ := NewOtto("js")
	a := `
eval(function(p,a,c,k,e,r){e=String;if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'[0]'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('0 dynamicurl="/WZWSRELw==";0 wzwsquestion="ZE7m$C6` + `)Yp<l";0 wzwsfactor="8635";0 wzwsmethod="WZWS_METHOD";0 wzwsparams="WZWS_PARAMS";',[],1,'var'.split('|'),0,{}))
`
	b := `var encode_version = 'sojson.v5', qxpgb = '__0x31a2a',  __0x31a2a=['dhvCugsb','c8OqwoYrQQ==','AMO/woHCnUnDhigI','w7hubn3DisOcT8OiSsO8w4BUwo4=','wovDuVLDtcKQ','w5vDgHzCnw==','RCVufcKFwqPCo0TCsT7DrA==','ccKsw7HDtA==','w7fCg0rCt8KkBcOjwpLDhG7CkA==','M8KyRS/ClQ==','b8KAYMK7w50=','w7rDuxrCjiNXCQ==','TSvCoi4F','AcOcwojDvk7Cn8O4dQ==','H8OYcAc1','w6bCv2nCnsKT','w6rDm8OnwozCgw==','cgrCsg==','woNKTxvDssO4Yj4=','wq/Cp8KYwrjCrcKISMKpfsO7','5Lq46IGc5Yix6ZqeLlfDgcKIwpDCt21fwpY=','cCwfKXMtXsKgWA==','w5EuwrfDuG5Twrwgcw==','wpvDmUrDm8KR','w6vDjsOGwoLCmQ==','w6XCjkDCosKe','B8O+SMOwHg==','wr8Uw6hOBzs=','wpvDoV/DrsKnGsK4amTDqQ==','wpvDoV/DrsKlAQ==','w6fDqiTChyU=','w4NEOsKtRQ==','eW3CvMOYTA==','f8KceMKlw7sXw45iFTo=','w7g7ZMOGw4hh','w5kXVcOdw4A=','wposMMK6wowz','w5cnUcOnw7w=','w5fDksOsw5A1','w5sVwojDgkM=','woHCl8Kww5TDhgY=','wrIww7NWAw==','bsO4wqUZQg==','w5jDiVgmJsKg','w7vDgMO8w5Vpw4k=','a8Odw6bCt8ODaSHDiWgHAw==','w4IBacOcw6c=','ScKTJQF2','ZVjCusOm','Z8KzMA==','w4YzK8K/wr4kw78Dw6sNKz/Dn8KKLw==','w6fDisOhw4Y=','YAY+AFg=','w4/ComPCosKQ','JjXDhsOnGcKr','w4HCk0bCuMK6Ng==','DsOBXcORFsKt','w7U5wqXDqlY=','GsOkwpbCusK3','wpEfw7s=','w57ChFjClcKv','ejXCihcR','TRNXfcK5','w4oHwpTDrlM=','w4/DnBYIw5w='];(function(_0x231fd0,_0x4f680a){var _0x5b4826=function(_0x4a3682){while(--_0x4a3682){_0x231fd0['push'](_0x231fd0['shift']());}};var _0x18d5c9=function(){var _0x4ce2f1={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x333808,_0x432180,_0x2ab90b,_0x991246){_0x991246=_0x991246||{};var _0x981158=_0x432180+'='+_0x2ab90b;var _0x57b080=0x0;for(var _0x57b080=0x0,_0x441e3a=_0x333808['length'];_0x57b080<_0x441e3a;_0x57b080++){var _0x2cc193=_0x333808[_0x57b080];_0x981158+=';\x20'+_0x2cc193;var _0x5f41ea=_0x333808[_0x2cc193];_0x333808['push'](_0x5f41ea);_0x441e3a=_0x333808['length'];if(_0x5f41ea!==!![]){_0x981158+='='+_0x5f41ea;}}_0x991246['cookie']=_0x981158;},'removeCookie':function(){return'dev';},'getCookie':function(_0x503809,_0xe42b77){_0x503809=_0x503809||function(_0x56465b){return _0x56465b;};var _0x52cace=_0x503809(new RegExp('(?:^|;\x20)'+_0xe42b77['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x39753a=function(_0xf81284,_0x307b3e){_0xf81284(++_0x307b3e);};_0x39753a(_0x5b4826,_0x4f680a);return _0x52cace?decodeURIComponent(_0x52cace[0x1]):undefined;}};var _0x3ab53f=function(){var _0xfeb75b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xfeb75b['test'](_0x4ce2f1['removeCookie']['toString']());};_0x4ce2f1['updateCookie']=_0x3ab53f;var _0xbd1168='';var _0x4a4c56=_0x4ce2f1['updateCookie']();if(!_0x4a4c56){_0x4ce2f1['setCookie'](['*'],'counter',0x1);}else if(_0x4a4c56){_0xbd1168=_0x4ce2f1['getCookie'](null,'counter');}else{_0x4ce2f1['removeCookie']();}};_0x18d5c9();}(__0x31a2a,0x1dc));var _0x213d=function(_0xe8191e,_0x5b709c){_0xe8191e=_0xe8191e-0x0;var _0x32912a=__0x31a2a[_0xe8191e];if(_0x213d['initialized']===undefined){(function(){var _0x49d973=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x3e050f='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x49d973['atob']||(_0x49d973['atob']=function(_0x15378c){var _0x4a714d=String(_0x15378c)['replace'](/=+$/,'');for(var _0x46149c=0x0,_0xf1b84f,_0xe5f135,_0x36914d=0x0,_0x2a8f2b='';_0xe5f135=_0x4a714d['charAt'](_0x36914d++);~_0xe5f135&&(_0xf1b84f=_0x46149c%0x4?_0xf1b84f*0x40+_0xe5f135:_0xe5f135,_0x46149c++%0x4)?_0x2a8f2b+=String['fromCharCode'](0xff&_0xf1b84f>>(-0x2*_0x46149c&0x6)):0x0){_0xe5f135=_0x3e050f['indexOf'](_0xe5f135);}return _0x2a8f2b;});}());var _0xc94208=function(_0xbf7cb5,_0x14538c){var _0x4b4e10=[],_0x4f827e=0x0,_0x121b41,_0x3198c7='',_0x390bec='';_0xbf7cb5=atob(_0xbf7cb5);for(var _0x80d343=0x0,_0x3b356f=_0xbf7cb5['length'];_0x80d343<_0x3b356f;_0x80d343++){_0x390bec+='%'+('00'+_0xbf7cb5['charCodeAt'](_0x80d343)['toString'](0x10))['slice'](-0x2);}_0xbf7cb5=decodeURIComponent(_0x390bec);for(var _0x2ed4db=0x0;_0x2ed4db<0x100;_0x2ed4db++){_0x4b4e10[_0x2ed4db]=_0x2ed4db;}for(_0x2ed4db=0x0;_0x2ed4db<0x100;_0x2ed4db++){_0x4f827e=(_0x4f827e+_0x4b4e10[_0x2ed4db]+_0x14538c['charCodeAt'](_0x2ed4db%_0x14538c['length']))%0x100;_0x121b41=_0x4b4e10[_0x2ed4db];_0x4b4e10[_0x2ed4db]=_0x4b4e10[_0x4f827e];_0x4b4e10[_0x4f827e]=_0x121b41;}_0x2ed4db=0x0;_0x4f827e=0x0;for(var _0xfae646=0x0;_0xfae646<_0xbf7cb5['length'];_0xfae646++){_0x2ed4db=(_0x2ed4db+0x1)%0x100;_0x4f827e=(_0x4f827e+_0x4b4e10[_0x2ed4db])%0x100;_0x121b41=_0x4b4e10[_0x2ed4db];_0x4b4e10[_0x2ed4db]=_0x4b4e10[_0x4f827e];_0x4b4e10[_0x4f827e]=_0x121b41;_0x3198c7+=String['fromCharCode'](_0xbf7cb5['charCodeAt'](_0xfae646)^_0x4b4e10[(_0x4b4e10[_0x2ed4db]+_0x4b4e10[_0x4f827e])%0x100]);}return _0x3198c7;};_0x213d['rc4']=_0xc94208;_0x213d['data']={};_0x213d['initialized']=!![];}var _0x253d5a=_0x213d['data'][_0xe8191e];if(_0x253d5a===undefined){if(_0x213d['once']===undefined){var _0xe2055f=function(_0xac42b6){this['rc4Bytes']=_0xac42b6;this['states']=[0x1,0x0,0x0];this['newState']=function(){return'newState';};this['firstState']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*';this['secondState']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xe2055f['prototype']['checkState']=function(){var _0x3d707c=new RegExp(this['firstState']+this['secondState']);return this['runState'](_0x3d707c['test'](this['newState']['toString']())?--this['states'][0x1]:--this['states'][0x0]);};_0xe2055f['prototype']['runState']=function(_0x3ebbf7){if(!Boolean(~_0x3ebbf7)){return _0x3ebbf7;}return this['getState'](this['rc4Bytes']);};_0xe2055f['prototype']['getState']=function(_0x57b0a7){for(var _0x88219d=0x0,_0x330957=this['states']['length'];_0x88219d<_0x330957;_0x88219d++){this['states']['push'](Math['round'](Math['random']()));_0x330957=this['states']['length'];}return _0x57b0a7(this['states'][0x0]);};new _0xe2055f(_0x213d)['checkState']();_0x213d['once']=!![];}_0x32912a=_0x213d['rc4'](_0x32912a,_0x5b709c);_0x213d['data'][_0xe8191e]=_0x32912a;}else{_0x32912a=_0x253d5a;}return _0x32912a;};if(typeof encode_version!==_0x213d('0x0','XkR5')&&encode_version===_0x213d('0x1','!]@N')){function _0x553680(_0x32d249){var _0x1c847c={'cPtGu':'0|7|3|4|5|6|2|1','aVkgN':'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=','WhdwM':function _0x2029b6(_0x484c89,_0x2e22a4){return _0x484c89<_0x2e22a4;},'zZtSk':function _0x4b483e(_0x225021,_0x5322d4){return _0x225021&_0x5322d4;},'yxMyj':function _0x6d0532(_0x310c89,_0x2a03ba){return _0x310c89<<_0x2a03ba;},'BDPiI':function _0x304a66(_0x3ff9d0,_0x3c82e9){return _0x3ff9d0>>_0x3c82e9;},'LtTSu':function _0x48419d(_0x286b15,_0x960eb){return _0x286b15|_0x960eb;},'yTUIB':function _0x2782eb(_0x5338f7,_0x3bb613){return _0x5338f7&_0x3bb613;},'VhjDq':function _0x3e7647(_0x161d3c,_0x4c997b){return _0x161d3c|_0x4c997b;},'nLzjE':function _0x23c4f3(_0x33ac1f,_0x5ca1f7){return _0x33ac1f&_0x5ca1f7;},'iddHe':function _0x17025a(_0x818a42,_0x44b28e){return _0x818a42&_0x44b28e;}};var _0x1da315=_0x1c847c[_0x213d('0x2','DE2z')][_0x213d('0x3','Z@gv')]('|'),_0x15b147=0x0;while(!![]){switch(_0x1da315[_0x15b147++]){case'0':var _0x177543=_0x1c847c['aVkgN'];continue;case'1':return _0x112513;case'2':while(_0x1c847c[_0x213d('0x4','dP^[')](_0x24ff86,_0x23d27d)){_0x73b9cc=_0x1c847c[_0x213d('0x5','yNIT')](_0x32d249['charCodeAt'](_0x24ff86++),0xff);if(_0x24ff86==_0x23d27d){_0x112513+=_0x177543['charAt'](_0x73b9cc>>0x2);_0x112513+=_0x177543[_0x213d('0x6','cLs0')]((_0x73b9cc&0x3)<<0x4);_0x112513+='==';break;}_0x4190cc=_0x32d249[_0x213d('0x7','DE2z')](_0x24ff86++);if(_0x24ff86==_0x23d27d){_0x112513+=_0x177543['charAt'](_0x73b9cc>>0x2);_0x112513+=_0x177543[_0x213d('0x8','DE2z')](_0x1c847c[_0x213d('0x9','5KjR')](_0x73b9cc&0x3,0x4)|_0x1c847c['BDPiI'](_0x1c847c[_0x213d('0xa','T5XA')](_0x4190cc,0xf0),0x4));_0x112513+=_0x177543['charAt'](_0x1c847c[_0x213d('0xb','&c)N')](_0x4190cc,0xf)<<0x2);_0x112513+='=';break;}_0x2c7076=_0x32d249[_0x213d('0xc','!#1F')](_0x24ff86++);_0x112513+=_0x177543[_0x213d('0xd','i2Wk')](_0x1c847c[_0x213d('0xe','i2Wk')](_0x73b9cc,0x2));_0x112513+=_0x177543[_0x213d('0xf','WRpw')](_0x1c847c[_0x213d('0x10','i2Wk')](_0x1c847c[_0x213d('0x11','GSaA')](_0x73b9cc,0x3)<<0x4,_0x1c847c[_0x213d('0x12','!]@N')](_0x4190cc,0xf0)>>0x4));_0x112513+=_0x177543[_0x213d('0x13','nh*[')](_0x1c847c['VhjDq'](_0x1c847c['yxMyj'](_0x1c847c[_0x213d('0x14','cLs0')](_0x4190cc,0xf),0x2),_0x1c847c[_0x213d('0x15','7l7L')](_0x2c7076,0xc0)>>0x6));_0x112513+=_0x177543[_0x213d('0x16','Qau5')](_0x2c7076&0x3f);}continue;case'3':var _0x73b9cc,_0x4190cc,_0x2c7076;continue;case'4':_0x23d27d=_0x32d249[_0x213d('0x17','o)%3')];continue;case'5':_0x24ff86=0x0;continue;case'6':_0x112513='';continue;case'7':var _0x112513,_0x24ff86,_0x23d27d;continue;}break;}}function _0x5221bc(){var _0x434d12={'YRlhn':_0x213d('0x18','(Y3$'),'BQzMZ':function _0x2407d1(_0x2aed36,_0x448ece){return _0x2aed36<_0x448ece;},'nxjDT':function _0x1d5251(_0x22a0b4,_0x494b97){return _0x22a0b4+_0x494b97;},'csKNI':'WZWS_CONFIRM_PREFIX_LABEL'};var _0x1881a1=_0x434d12[_0x213d('0x19','i2Wk')]['split']('|'),_0x386713=0x0;while(!![]){switch(_0x1881a1[_0x386713++]){case'0':for(_0x710a7=0x0;_0x434d12[_0x213d('0x1a','x&tC')](_0x710a7,wzwsquestion['length']);_0x710a7++){_0x4de8cc+=wzwsquestion['charCodeAt'](_0x710a7);}continue;case'1':_0x4de8cc*=wzwsfactor;continue;case'2':var _0x4de8cc=0x0;continue;case'3':_0x4de8cc+=0x1b207;continue;case'4':var _0x710a7=0x0;continue;case'5':return _0x434d12['nxjDT'](_0x434d12['csKNI'],_0x4de8cc);}break;}}function _0x3b5c6a(_0x1dd18a,_0x3a861f){var _0x25fab3={'eDELM':'0|1|5|7|3|4|2|6','YQYpZ':_0x213d('0x1b','&c)N'),'Fxxhk':function _0x2437c8(_0x292d56,_0x42c325){return _0x292d56!=_0x42c325;},'WxxaW':function _0x207b2d(_0x438adc,_0x263f95){return _0x438adc<_0x263f95;},'CEDqD':function _0x56b710(_0x177835,_0x214522){return _0x177835!==_0x214522;},'pKuTQ':_0x213d('0x1c','x&tC'),'HwbGe':function _0x1bdf9e(_0x3baa96){return _0x3baa96();},'yvILb':function _0x58097e(_0x282f40,_0x32384a){return _0x282f40(_0x32384a);},'hFIeR':function _0x40fe55(_0x336474,_0x2adcd0){return _0x336474+_0x2adcd0;},'MYAlY':_0x213d('0x1d','WRpw'),'dnJUw':function _0x4b56f3(_0x1c1f2a,_0x536528){return _0x1c1f2a==_0x536528;},'uXyPh':_0x213d('0x1e','o)%3'),'tvGzf':function _0x158de7(_0x469c35,_0xdf78fa,_0xae209f){return _0x469c35(_0xdf78fa,_0xae209f);}};var _0x5dfc86=_0x25fab3[_0x213d('0x1f','XkR5')]['split']('|'),_0x2af038=0x0;while(!![]){switch(_0x5dfc86[_0x2af038++]){case'0':var _0x4dd19b=document['createElement'](_0x25fab3[_0x213d('0x20','VFJZ')]);continue;case'1':_0x4dd19b[_0x213d('0x21','%1j1')]=_0x1dd18a;continue;case'2':_0x4dd19b[_0x213d('0x22','dP^[')]();continue;case'3':if(_0x25fab3['Fxxhk'](_0x3a861f[_0x213d('0x23','yNIT')]('='),-0x1)){var _0x554240=_0x3a861f['split']('&');for(var _0x3ee145=0x0;_0x25fab3[_0x213d('0x24','!]@N')](_0x3ee145,_0x554240['length']);_0x3ee145++){if(_0x25fab3[_0x213d('0x25','(Y3$')](_0x25fab3['pKuTQ'],_0x213d('0x26','(M6F'))){var _0x55bbef=_0x25fab3[_0x213d('0x27','VFJZ')](_0x5221bc);var _0x58ba9d=_0x25fab3[_0x213d('0x28','#eYs')](_0x553680,_0x55bbef['toString']());var _0x3ddd13=_0x25fab3[_0x213d('0x29','9382')](_0x25fab3[_0x213d('0x2a','!]@N')](dynamicurl,_0x25fab3['MYAlY']),_0x58ba9d);if(_0x25fab3[_0x213d('0x2b','aky8')](wzwsmethod,_0x25fab3[_0x213d('0x2c','#eYs')])){_0x25fab3[_0x213d('0x2d','7l7L')](_0x3b5c6a,_0x3ddd13,_0x3a861f);}else{window[_0x213d('0x2e','!QBG')]=_0x3ddd13;}}else{var _0x2b6cfa=document[_0x213d('0x2f','BJN7')]('textarea');var _0x3d8aa1=_0x554240[_0x3ee145];var _0x258367=_0x3d8aa1[_0x213d('0x30','DE2z')]('=');_0x2b6cfa[_0x213d('0x31','41Yz')]=_0x258367[0x0];_0x2b6cfa['value']=_0x258367[0x1];_0x4dd19b[_0x213d('0x32','9382')](_0x2b6cfa);}}}continue;case'4':document[_0x213d('0x33','jq9O')][_0x213d('0x34','VFJZ')](_0x4dd19b);continue;case'5':_0x4dd19b['method']=_0x25fab3[_0x213d('0x35','yZ6K')];continue;case'6':return _0x4dd19b;case'7':_0x4dd19b[_0x213d('0x36','!#1F')][_0x213d('0x37','5KjR')]='none';continue;}break;}}function _0xd1b242(){var _0x1acce7=function(){var _0x6488f9=!![];return function(_0x3bbd97,_0x5627c2){var _0x523fa8=_0x6488f9?function(){if(_0x5627c2){var _0x4760bb=_0x5627c2['apply'](_0x3bbd97,arguments);_0x5627c2=null;return _0x4760bb;}}:function(){};_0x6488f9=![];return _0x523fa8;};}();var _0x2e3aa7=_0x1acce7(this,function(){var _0x577165=function(){return'\x64\x65\x76';},_0x4c97b9=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x1f9cea=function(){var _0x154e1f=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x154e1f['\x74\x65\x73\x74'](_0x577165['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x278471=function(){var _0x137a46=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x137a46['\x74\x65\x73\x74'](_0x4c97b9['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5ac1b3=function(_0x25c7a2){var _0x58da58=~-0x1>>0x1+0xff%0x0;if(_0x25c7a2['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x58da58)){_0x1a1ca1(_0x25c7a2);}};var _0x1a1ca1=function(_0x36a02a){var _0x302e37=~-0x4>>0x1+0xff%0x0;if(_0x36a02a['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x302e37){_0x5ac1b3(_0x36a02a);}};if(!_0x1f9cea()){if(!_0x278471()){_0x5ac1b3('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x5ac1b3('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x5ac1b3('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x2e3aa7();var _0x358b35={'Nhauv':function _0x5d1188(_0x3351bf,_0x3aabb7){return _0x3351bf(_0x3aabb7);},'hZZjg':function _0x37d045(_0xa6bd2e,_0x40e6c3){return _0xa6bd2e+_0x40e6c3;},'gqmoA':'?wzwschallenge=','DRDzI':'post','pLSLY':function _0xe34b61(_0xa24fd2,_0x555c76,_0xfd859){return _0xa24fd2(_0x555c76,_0xfd859);},'reMgn':function _0x1152c8(_0x3c545f,_0xf3ec93){return _0x3c545f!==_0xf3ec93;}};var _0x23c204=_0x5221bc();var _0x21ccbd=_0x358b35[_0x213d('0x38','#eYs')](_0x553680,_0x23c204[_0x213d('0x39','eymL')]());var _0xcd071f=_0x358b35[_0x213d('0x3a','xtNn')](dynamicurl+_0x358b35['gqmoA'],_0x21ccbd);if(wzwsmethod==_0x358b35['DRDzI']){_0x358b35[_0x213d('0x3b','VFJZ')](_0x3b5c6a,_0xcd071f,wzwsparams);}else{if(_0x358b35[_0x213d('0x3c','Z@gv')](_0x213d('0x3d','#eYs'),'eOa')){window[_0x213d('0x3e','NS17')]=_0xcd071f;}else{hash+=wzwsquestion[_0x213d('0x3f','WXxL')](i);}}}_0xd1b242();}else{alert(_0x213d('0x40','41Yz'));};encode_version = 'sojson.v5';
`

	_ = a
	_, err := jse.Run(a)
	_, err = jse.Run(b)
	c, err := JSRun(err, jse, `window.location`)

	fmt.Println(c)
	// xc, err := JSRun(err, jse, "document.cookie")

	// t, err := JSCall(err, jse, "CrashTemplate")
	// c, err := JSCall(err, jse, "CrashChallenge")
	// uri, err := JSCall(err, jse, "DynamicURI")

	// body, _ := ioutil.ReadFile("index.html.2")
	// uri, t, c, err := WZWSRedirect(string(body), jse)
	// fmt.Println(uri, err)
	// fmt.Println(t)
	// fmt.Println(c)

	// Output: /WZWSRELw== <nil>
	// Mw==
	// V1pXU19DT05GSVJNX1BSRUZJWF9MQUJFTDMxMjM4NjU=
}
